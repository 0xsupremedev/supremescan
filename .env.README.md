# SupremeScan - Environment Configuration Guide

## Quick Start

1. **Copy the example file**:
   ```bash
   cp .env.example .env
   ```

2. **Update the values** in `.env` with your actual configuration

3. **Never commit `.env`** to version control (it's already in `.gitignore`)

## Required Variables

### Database
- `SUPREMESCAN_DB_URL`: PostgreSQL connection string
  - Format: `postgresql://username:password@host:port/database`
  - Example: `postgresql://postgres:mypassword@localhost:5432/supremescan`

### Server
- `PORT`: Server port (default: 4000)
- `NODE_ENV`: Environment (development, production, test)

### Security
- `JWT_SECRET`: Secret key for JWT token signing (MUST be changed in production!)
  - Generate with: `node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"`
- `SESSION_SECRET`: Secret key for session management (MUST be changed in production!)
  - Generate with: `node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"`
- `BCRYPT_ROUNDS`: Number of bcrypt hashing rounds (default: 10, higher = more secure but slower)

### CORS
- `ALLOWED_ORIGINS`: Comma-separated list of allowed origins
  - Example: `http://localhost:3000,https://yourdomain.com`

### Rate Limiting
- `RATE_LIMIT_WINDOW_MS`: Time window in milliseconds (default: 15 minutes)
- `RATE_LIMIT_MAX_REQUESTS`: Max requests per window (default: 100)

## Production Deployment

### Security Checklist
- [ ] Change `JWT_SECRET` to a random 32+ character string
- [ ] Change `SESSION_SECRET` to a random 32+ character string
- [ ] Set `NODE_ENV=production`
- [ ] Use a secure PostgreSQL connection string with strong password
- [ ] Update `ALLOWED_ORIGINS` to your production domain only
- [ ] Consider lowering `RATE_LIMIT_MAX_REQUESTS` for production
- [ ] Never expose `.env` file or commit it to git

### Generating Secure Secrets

Run these commands to generate cryptographically secure secrets:

```bash
# For JWT_SECRET
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

# For SESSION_SECRET
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

## Optional Configuration

### Error Tracking (Sentry)
```env
SENTRY_DSN=https://your-sentry-dsn-here
```

### Email Service (SMTP)
```env
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@example.com
SMTP_PASSWORD=your-app-password
```

## Database Setup

1. **Install PostgreSQL** if not already installed

2. **Create the database**:
   ```bash
   createdb supremescan
   ```

3. **Run migrations**:
   ```bash
   psql supremescan < migrations/001_create_rules_schema.sql
   psql supremescan < migrations/002_projects_scans.sql
   ```

4. **Update `.env`** with your database connection string

## Troubleshooting

### "Cannot connect to database"
- Check that PostgreSQL is running
- Verify `SUPREMESCAN_DB_URL` is correct
- Ensure the database exists
- Check username/password are correct

### "JWT_SECRET is required"
- Ensure `.env` file exists
- Check `JWT_SECRET` is set in `.env`
- Restart the server after changing `.env`

### "CORS error"
- Add your frontend URL to `ALLOWED_ORIGINS`
- Separate multiple origins with commas
- Include the protocol (http:// or https://)
